@page "/game"
@inject GameSessionState GameSessionState;
@using TitlesWebGame.WebUi.Services
@using TitlesWebGame.WebUi.ViewModels
@using System.ComponentModel
@using TitlesWebGame.WebUi.Annotations
@implements IDisposable;
@inject GameViewModel GameViewModel; 


<CascadingValue Value="@GameViewModel" Name="GameViewModel">
    <GameSessionLobby />
</CascadingValue>

@code {

    protected override async Task OnInitializedAsync()
    {
        GameViewModel.PropertyChanged += OnPropertyChangedHandler;
        await base.OnInitializedAsync();
    }
    
    private void OnPropertyChangedHandler([CanBeNull] object sender, PropertyChangedEventArgs e)
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        GameViewModel.PropertyChanged -= OnPropertyChangedHandler;
        GameViewModel.Dispose();
    }
    
    

}