@using TitlesWebGame.WebUi.ViewModels
@using TitlesWebGame.WebUi.Services
@using Newtonsoft.Json
@using TitlesWebGame.Domain.ViewModels
@inject GameSocketConnectionManager GameSocketConnectionManager

<div>
    
</div>

@code {
    [CascadingParameter(Name = "GameViewModel")]
    protected GameViewModel GameViewModel { get; set; }

    private List<GameRoundAnswer> _answers;
    
    protected override async Task OnInitializedAsync()
    {
        var responseMessage = await GameSocketConnectionManager.GetAnswerWithData(GameViewModel.RoomKey);
        var responseJson = await responseMessage.Content.ReadAsStringAsync();
        _answers = JsonConvert.DeserializeObject<List<GameRoundAnswer>>(responseJson);

        Console.WriteLine(_answers[0].ConnectionId);
        
        await base.OnInitializedAsync();
    }

}